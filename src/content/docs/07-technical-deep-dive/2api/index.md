---
title: æŠ€æœ¯å‘ Â· 2API
description: 2API çš„æ•´ä½“è¯´æ˜ä¸å¯¼èˆªã€‚
---

# 2APIï¼šå¤§æ¨¡å‹æ¥å£é€†å‘å·¥ç¨‹æŠ€æœ¯

2APIæ˜¯æŒ‡é€šè¿‡å¯¹å•†ä¸šå¤§è¯­è¨€æ¨¡å‹æœåŠ¡çš„å®¢æˆ·ç«¯æˆ–ç½‘é¡µåº”ç”¨è¿›è¡Œé€†å‘å·¥ç¨‹åˆ†æï¼Œå°†å…¶ä¸“æœ‰åè®®è½¬æ¢ä¸ºæ ‡å‡†çš„OpenAI APIå…¼å®¹æ¥å£çš„æŠ€æœ¯æ–¹æ¡ˆã€‚è¿™ç§æŠ€æœ¯ä½¿ç”¨æˆ·èƒ½å¤Ÿä»¥ç»Ÿä¸€çš„APIæ¥å£è°ƒç”¨å„ç§åŸæœ¬å°é—­çš„å¤§è¯­è¨€æ¨¡å‹æœåŠ¡ã€‚

## ğŸ§© æ ¸å¿ƒæ¦‚å¿µ

### ä»€ä¹ˆæ˜¯2API

2APIçš„æ ¸å¿ƒæ€æƒ³æ˜¯"äºŒæ¬¡æ¥å£åŒ–"ï¼Œå³å°†å·²æœ‰çš„LLMæœåŠ¡é€šè¿‡ä¸­é—´å±‚è½¬æ¢ä¸ºæ ‡å‡†çš„APIæ¥å£ã€‚è¿™é‡Œçš„"2"æ—¢ä»£è¡¨"to"ï¼ˆè½¬æ¢ä¸ºï¼‰ï¼Œä¹Ÿæš—ç¤ºäº†"äºŒæ¬¡å°è£…"çš„æ¦‚å¿µã€‚

```mermaid
graph LR
    A[å®¢æˆ·ç«¯åº”ç”¨] --> B[2APIä¸­é—´å±‚]
    B --> C[OpenAIå…¼å®¹æ¥å£]
    B --> D[åŸå§‹LLMæœåŠ¡]

    style B fill:#e1f5fe
    style C fill:#c8e6c9
```

### æŠ€æœ¯åŸç†

2APIçš„å®ç°ä¸»è¦ä¾èµ–äºä»¥ä¸‹å‡ ä¸ªå…³é”®æŠ€æœ¯ï¼š

1. **ç½‘ç»œæµé‡åˆ†æ**ï¼šé€šè¿‡æŠ“åŒ…å·¥å…·åˆ†æå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡åè®®
2. **APIé€†å‘å·¥ç¨‹**ï¼šè§£æä¸“æœ‰çš„APIè°ƒç”¨æ ¼å¼ã€å‚æ•°ç»“æ„å’Œè®¤è¯æœºåˆ¶
3. **åè®®è½¬æ¢**ï¼šå°†ä¸“æœ‰åè®®è½¬æ¢ä¸ºOpenAI APIçš„æ ‡å‡†æ ¼å¼
4. **è®¤è¯æ¨¡æ‹Ÿ**ï¼šæ¨¡æ‹ŸåŸå§‹å®¢æˆ·ç«¯çš„è®¤è¯æ–¹å¼ï¼Œç»´æŒä¸æœåŠ¡å™¨çš„åˆæ³•è¿æ¥

## ğŸ¯ ä¸»è¦åº”ç”¨åœºæ™¯

### 1. ç»Ÿä¸€æ¥å£è°ƒç”¨

é€šè¿‡2APIï¼Œå¼€å‘è€…å¯ä»¥ä½¿ç”¨ç›¸åŒçš„ä»£ç è°ƒç”¨ä¸åŒçš„LLMæœåŠ¡ï¼š

```python
# ç¤ºä¾‹ï¼šç»Ÿä¸€æ¥å£è°ƒç”¨ä¸åŒæ¨¡å‹
import openai

# é…ç½®2APIç«¯ç‚¹
openai.api_base = "http://localhost:8000/v1"
openai.api_key = "your-proxy-key"

# è°ƒç”¨ä¸åŒæ¨¡å‹
response = openai.ChatCompletion.create(
    model="claude-3-sonnet",  # åŸæœ¬æ˜¯Claudeçš„ä¸“æœ‰æ¥å£
    messages=[{"role": "user", "content": "Hello"}]
)
```

### 2. æˆæœ¬ä¼˜åŒ–

æŸäº›æƒ…å†µä¸‹ï¼Œé€šè¿‡2APIå¯ä»¥é™ä½ä½¿ç”¨æˆæœ¬ï¼š
- ç»•è¿‡å®˜æ–¹APIçš„é«˜é¢è´¹ç”¨
- åˆ©ç”¨å®¢æˆ·ç«¯åº”ç”¨çš„ä¼˜æƒ æ´»åŠ¨
- æ‰¹é‡é‡‡è´­çš„è´¦å·èµ„æº

### 3. åŠŸèƒ½æ‰©å±•

2APIè¿˜å¯ä»¥æä¾›å®˜æ–¹APIä¸å…·å¤‡çš„åŠŸèƒ½ï¼š
- æ›´é«˜çš„è¯·æ±‚é¢‘ç‡é™åˆ¶
- è‡ªå®šä¹‰æ¨¡å‹å‚æ•°è°ƒæ•´
- å¤šè´¦å·è´Ÿè½½å‡è¡¡

## âš™ï¸ å®ç°æ¶æ„

### åŸºæœ¬æ¶æ„å›¾

```mermaid
graph TB
    subgraph "ç”¨æˆ·åº”ç”¨"
        A[åº”ç”¨/è„šæœ¬]
    end

    subgraph "2APIä»£ç†å±‚"
        B[HTTPæœåŠ¡å™¨]
        C[åè®®è½¬æ¢å™¨]
        D[è®¤è¯ç®¡ç†å™¨]
    end

    subgraph "ç›®æ ‡æœåŠ¡"
        E[Claude Web]
        F[GPTå®¢æˆ·ç«¯]
        G[å…¶ä»–LLMæœåŠ¡]
    end

    A --> B
    B --> C
    C --> D
    D --> E
    D --> F
    D --> G

    style C fill:#fff3e0
    style D fill:#fce4ec
```

### æ ¸å¿ƒç»„ä»¶

1. **HTTPæœåŠ¡å™¨**ï¼šæä¾›OpenAIå…¼å®¹çš„REST APIæ¥å£
2. **åè®®è½¬æ¢å™¨**ï¼šå¤„ç†ä¸åŒLLMæœåŠ¡çš„åè®®å·®å¼‚
3. **ä¼šè¯ç®¡ç†**ï¼šç»´æŠ¤ä¸åŸå§‹æœåŠ¡çš„è¿æ¥çŠ¶æ€
4. **è®¤è¯ç³»ç»Ÿ**ï¼šå¤„ç†å„ç§è®¤è¯æ–¹å¼å’Œtokenç®¡ç†

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### 1. æµå¼å“åº”å¤„ç†

```javascript
// ç¤ºä¾‹ï¼šå¤„ç†Claudeçš„æµå¼å“åº”
async function* claudeStreamToOpenAI(claudeResponse) {
    for await (const chunk of claudeResponse) {
        const openaiChunk = {
            id: generateId(),
            object: "chat.completion.chunk",
            created: Math.floor(Date.now() / 1000),
            model: "claude-3-sonnet",
            choices: [{
                index: 0,
                delta: {
                    content: chunk.text
                },
                finish_reason: chunk.stop ? "stop" : null
            }]
        };
        yield `data: ${JSON.stringify(openaiChunk)}\n\n`;
    }
}
```

### 2. æ¶ˆæ¯æ ¼å¼è½¬æ¢

```python
# Claudeæ ¼å¼åˆ°OpenAIæ ¼å¼çš„è½¬æ¢
def convert_claude_to_openai(messages):
    converted = []
    system_message = None

    for msg in messages:
        if msg['role'] == 'system':
            system_message = msg['content']
        else:
            converted.append({
                'role': msg['role'],
                'content': msg['content']
            })

    # Claudeå°†ç³»ç»Ÿæ¶ˆæ¯æ”¾åœ¨è¯·æ±‚ä½“çš„é¡¶å±‚
    if system_message:
        return converted, system_message
    return converted, None
```

## âš–ï¸ æ³•å¾‹ä¸ä¼¦ç†è€ƒé‡

### æ³•å¾‹é£é™©

ä½¿ç”¨2APIæŠ€æœ¯å¯èƒ½æ¶‰åŠä»¥ä¸‹æ³•å¾‹é£é™©ï¼š

1. **æœåŠ¡æ¡æ¬¾è¿å**ï¼šå¤§å¤šæ•°LLMæœåŠ¡æ˜ç¡®ç¦æ­¢é€†å‘å·¥ç¨‹
2. **ç‰ˆæƒé—®é¢˜**ï¼šå®¢æˆ·ç«¯åº”ç”¨çš„é€†å‘å¯èƒ½æ¶‰åŠç‰ˆæƒ
3. **æ•°æ®å®‰å…¨**ï¼šç»•è¿‡å®˜æ–¹APIå¯èƒ½å½±å“æ•°æ®å®‰å…¨

### ä¼¦ç†ä½¿ç”¨å»ºè®®

- ä»…ç”¨äºä¸ªäººå­¦ä¹ å’Œç ”ç©¶ç›®çš„
- ä¸ç”¨äºå•†ä¸šç”¨é€”æˆ–å¤§è§„æ¨¡éƒ¨ç½²
- å°Šé‡åŸå§‹æœåŠ¡çš„çŸ¥è¯†äº§æƒ
- ä¿æŠ¤ç”¨æˆ·æ•°æ®å’Œéšç§

## ğŸ› ï¸ å¸¸è§2APIå®ç°

### 1. Claude APIä»£ç†

é€šè¿‡æ¨¡æ‹ŸClaudeç½‘é¡µç‰ˆå®¢æˆ·ç«¯å®ç°ï¼š

```python
# ç®€åŒ–çš„Claudeä»£ç†ç¤ºä¾‹
class ClaudeProxy:
    def __init__(self, session_token):
        self.session = self.create_session(session_token)

    async def chat_completion(self, messages, **kwargs):
        # è½¬æ¢æ¶ˆæ¯æ ¼å¼
        claude_messages = self.convert_to_claude_format(messages)

        # è°ƒç”¨Claudeç½‘é¡µAPI
        response = await self.session.post(
            "https://claude.ai/api/append_message",
            json=claude_messages
        )

        # è½¬æ¢å“åº”æ ¼å¼
        return self.convert_to_openai_format(response)
```

### 2. å›½äº§æ¨¡å‹ä»£ç†

æ”¯æŒå›½å†…ä¸»æµå¤§è¯­è¨€æ¨¡å‹çš„ç»Ÿä¸€æ¥å£ï¼š

| æ¨¡å‹ | åŸå§‹æ¥å£ | 2APIæ”¯æŒçŠ¶æ€ |
|------|----------|-------------|
| æ–‡å¿ƒä¸€è¨€ | ä¸“æœ‰API | âœ… å®Œå…¨æ”¯æŒ |
| é€šä¹‰åƒé—® | é˜¿é‡Œäº‘API | âœ… å®Œå…¨æ”¯æŒ |
| Kimi | æœˆä¹‹æš—é¢API | âœ… å®Œå…¨æ”¯æŒ |
| æ™ºè°±æ¸…è¨€ | ä¸“æœ‰API | ğŸ”„ éƒ¨åˆ†æ”¯æŒ |

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

### å“åº”æ—¶é—´å¯¹æ¯”

| æœåŠ¡ç±»å‹ | å¹³å‡å“åº”æ—¶é—´ | ç¨³å®šæ€§ | æˆæœ¬ |
|----------|-------------|--------|------|
| å®˜æ–¹API | 1.2s | 99.9% | é«˜ |
| 2APIä»£ç† | 1.5s | 95% | ä¸­ |
| å®¢æˆ·ç«¯æ¨¡æ‹Ÿ | 2.0s | 85% | ä½ |

### åŠŸèƒ½æ”¯æŒçŸ©é˜µ

```mermaid
pie title åŠŸèƒ½å®Œæ•´æ€§å¯¹æ¯”
    "æµå¼å“åº”" : 90
    "å¤šè½®å¯¹è¯" : 85
    "ç³»ç»Ÿæç¤º" : 95
    "å·¥å…·è°ƒç”¨" : 60
    "å›¾åƒç†è§£" : 40
```

## ğŸ”® å‘å±•è¶‹åŠ¿

### æŠ€æœ¯å‘å±•æ–¹å‘

1. **åè®®æ ‡å‡†åŒ–**ï¼šå‘æ›´æ ‡å‡†çš„OpenAI APIæ ¼å¼é æ‹¢
2. **å¤šæ¨¡æ€æ”¯æŒ**ï¼šæ”¯æŒå›¾åƒã€éŸ³é¢‘ç­‰å¤šç§è¾“å…¥æ ¼å¼
3. **åˆ†å¸ƒå¼éƒ¨ç½²**ï¼šæ”¯æŒå¤šèŠ‚ç‚¹è´Ÿè½½å‡è¡¡
4. **æ™ºèƒ½è·¯ç”±**ï¼šæ ¹æ®è¯·æ±‚ç±»å‹è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜åç«¯

### ç¤¾åŒºç”Ÿæ€

2APIæŠ€æœ¯åœ¨å¼€æºç¤¾åŒºä¸­æœ‰ç€æ´»è·ƒçš„å‘å±•ï¼š

- **GitHubé¡¹ç›®**ï¼šä¼—å¤šå¼€æºå®ç°å¯ä¾›é€‰æ‹©
- **æ–‡æ¡£å®Œå–„**ï¼šç¤¾åŒºé©±åŠ¨çš„æ–‡æ¡£å’Œæ•™ç¨‹
- **æŠ€æœ¯äº¤æµ**ï¼šæ´»è·ƒçš„æŠ€æœ¯è®¨è®ºå’Œç»éªŒåˆ†äº«

## ğŸ“š ç›¸å…³èµ„æº

### å¼€æºé¡¹ç›®

- [claude-api-proxy](https://github.com/anthropics/claude-api-proxy) - Claude APIä»£ç†å®ç°
- [pandora-next](https://github.com/pandora-next/deploy) - å¤šæ¨¡å‹ç»Ÿä¸€ä»£ç†
- [one-api](https://github.com/songquanpeng/one-api) - å¤šæ¸ é“APIèšåˆ

### æŠ€æœ¯æ–‡æ¡£

- [OpenAI APIæ–‡æ¡£](https://platform.openai.com/docs/api-reference)
- [é€†å‘å·¥ç¨‹å·¥å…·æŒ‡å—](https://www.wireshark.org/docs/)
- [åè®®åˆ†ææœ€ä½³å®è·µ](https://tools.ietf.org/html/rfc2616)

---

**æ³¨æ„**ï¼š2APIæŠ€æœ¯ä¸»è¦ç”¨äºå­¦ä¹ ç ”ç©¶ç›®çš„ï¼Œä½¿ç”¨æ—¶è¯·éµå®ˆç›¸å…³æœåŠ¡æ¡æ¬¾å’Œæ³•å¾‹æ³•è§„ã€‚å¯¹äºç”Ÿäº§ç¯å¢ƒï¼Œå»ºè®®ä¼˜å…ˆä½¿ç”¨å®˜æ–¹APIæœåŠ¡ã€‚
