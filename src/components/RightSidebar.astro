---
// 自动化目录（TOC）组件：在客户端扫描正文 h2/h3/h4 构建目录
// 内容作者无需在各页面传入 headings，完全解耦内容与目录
import '../styles/right-sidebar.css'
const { headings = [] } = Astro.props
---

<div class="right-sidebar">
  <div class="toc-content">
    <div class="toc-title">目录</div>
    <nav class="toc-nav"></nav>
  </div>
</div>

<script type="module">
  import { setupRightSidebar } from '/src/scripts/toc.ts'
  // 构建目录并启用滚动高亮
  const stop = setupRightSidebar('.content-inner', '.toc-nav')
  if (import.meta?.hot) {
    import.meta.hot.on('vite:beforeUpdate', () => stop && stop())
  }
</script>
